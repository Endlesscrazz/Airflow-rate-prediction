--- Starting Full Evaluation Pipeline for Run: 'combined' | Exp ID: 3 ---

Loading data from dataset: 'gypsum_single_hole' (Material: gypsum)

Loading data from dataset: 'gypsum_single_hole2' (Material: gypsum)

Loading data from dataset: 'brick_cladding_single_hole' (Material: brick_cladding)

Total samples created after loading and splitting: 67
Sample counts per material:
 material
gypsum            47
brick_cladding    20
Name: count, dtype: int64

Creating hold-out set.
  Created hold-out set (11 samples). Using 56 for development.
Extracting Features (Dev Set):   0%|                                                                                        | 0/56 [00:00<?, ?it/s]Extracting Features (Dev Set):   2%|█▍                                                                              | 1/56 [00:01<01:21,  1.49s/it]Extracting Features (Dev Set):   4%|██▊                                                                             | 2/56 [00:02<01:04,  1.19s/it]Extracting Features (Dev Set):   5%|████▎                                                                           | 3/56 [00:04<01:12,  1.37s/it]Extracting Features (Dev Set):   7%|█████▋                                                                          | 4/56 [00:05<01:08,  1.31s/it]Extracting Features (Dev Set):   9%|███████▏                                                                        | 5/56 [00:06<01:02,  1.22s/it]Extracting Features (Dev Set):  11%|████████▌                                                                       | 6/56 [00:07<01:05,  1.31s/it]Extracting Features (Dev Set):  12%|██████████                                                                      | 7/56 [00:08<01:00,  1.24s/it]Extracting Features (Dev Set):  14%|███████████▍                                                                    | 8/56 [00:09<00:54,  1.13s/it]Extracting Features (Dev Set):  16%|████████████▊                                                                   | 9/56 [00:10<00:50,  1.08s/it]Extracting Features (Dev Set):  18%|██████████████                                                                 | 10/56 [00:11<00:49,  1.07s/it]Extracting Features (Dev Set):  20%|███████████████▌                                                               | 11/56 [00:12<00:48,  1.07s/it]Extracting Features (Dev Set):  21%|████████████████▉                                                              | 12/56 [00:13<00:46,  1.07s/it]Extracting Features (Dev Set):  23%|██████████████████▎                                                            | 13/56 [00:14<00:45,  1.06s/it]Extracting Features (Dev Set):  25%|███████████████████▊                                                           | 14/56 [00:15<00:43,  1.03s/it]Extracting Features (Dev Set):  27%|█████████████████████▏                                                         | 15/56 [00:16<00:41,  1.01s/it]Extracting Features (Dev Set):  29%|██████████████████████▌                                                        | 16/56 [00:17<00:39,  1.00it/s]Extracting Features (Dev Set):  30%|███████████████████████▉                                                       | 17/56 [00:18<00:38,  1.02it/s]Extracting Features (Dev Set):  32%|█████████████████████████▍                                                     | 18/56 [00:19<00:37,  1.00it/s]Extracting Features (Dev Set):  34%|██████████████████████████▊                                                    | 19/56 [00:21<00:40,  1.10s/it]Extracting Features (Dev Set):  36%|████████████████████████████▏                                                  | 20/56 [00:22<00:42,  1.17s/it]Extracting Features (Dev Set):  38%|█████████████████████████████▋                                                 | 21/56 [00:23<00:42,  1.23s/it]Extracting Features (Dev Set):  39%|███████████████████████████████                                                | 22/56 [00:25<00:42,  1.24s/it]Extracting Features (Dev Set):  41%|████████████████████████████████▍                                              | 23/56 [00:26<00:40,  1.22s/it]Extracting Features (Dev Set):  43%|█████████████████████████████████▊                                             | 24/56 [00:27<00:41,  1.31s/it]Extracting Features (Dev Set):  45%|███████████████████████████████████▎                                           | 25/56 [00:30<00:50,  1.62s/it]Extracting Features (Dev Set):  46%|████████████████████████████████████▋                                          | 26/56 [00:31<00:44,  1.50s/it]Extracting Features (Dev Set):  48%|██████████████████████████████████████                                         | 27/56 [00:32<00:42,  1.45s/it]Extracting Features (Dev Set):  50%|███████████████████████████████████████▌                                       | 28/56 [00:33<00:38,  1.38s/it]Extracting Features (Dev Set):  52%|████████████████████████████████████████▉                                      | 29/56 [00:35<00:34,  1.27s/it]Extracting Features (Dev Set):  54%|██████████████████████████████████████████▎                                    | 30/56 [00:36<00:31,  1.22s/it]Extracting Features (Dev Set):  55%|███████████████████████████████████████████▋                                   | 31/56 [00:37<00:28,  1.13s/it]Extracting Features (Dev Set):  57%|█████████████████████████████████████████████▏                                 | 32/56 [00:37<00:25,  1.07s/it]Extracting Features (Dev Set):  59%|██████████████████████████████████████████████▌                                | 33/56 [00:38<00:24,  1.06s/it]Extracting Features (Dev Set):  61%|███████████████████████████████████████████████▉                               | 34/56 [00:40<00:23,  1.06s/it]Extracting Features (Dev Set):  62%|█████████████████████████████████████████████████▍                             | 35/56 [00:41<00:22,  1.06s/it]Extracting Features (Dev Set):  64%|██████████████████████████████████████████████████▊                            | 36/56 [00:42<00:21,  1.06s/it]Extracting Features (Dev Set):  66%|████████████████████████████████████████████████████▏                          | 37/56 [00:43<00:19,  1.05s/it]Extracting Features (Dev Set):  68%|█████████████████████████████████████████████████████▌                         | 38/56 [00:44<00:18,  1.03s/it]Extracting Features (Dev Set):  70%|███████████████████████████████████████████████████████                        | 39/56 [00:45<00:17,  1.05s/it]Extracting Features (Dev Set):  71%|████████████████████████████████████████████████████████▍                      | 40/56 [00:46<00:16,  1.03s/it]Extracting Features (Dev Set):  73%|█████████████████████████████████████████████████████████▊                     | 41/56 [00:47<00:17,  1.16s/it]Extracting Features (Dev Set):  75%|███████████████████████████████████████████████████████████▎                   | 42/56 [00:49<00:16,  1.21s/it]Extracting Features (Dev Set):  77%|████████████████████████████████████████████████████████████▋                  | 43/56 [00:50<00:16,  1.30s/it]Extracting Features (Dev Set):  79%|██████████████████████████████████████████████████████████████                 | 44/56 [00:51<00:15,  1.31s/it]Extracting Features (Dev Set):  80%|███████████████████████████████████████████████████████████████▍               | 45/56 [00:53<00:14,  1.33s/it]Extracting Features (Dev Set):  82%|████████████████████████████████████████████████████████████████▉              | 46/56 [00:55<00:14,  1.46s/it]Extracting Features (Dev Set):  84%|██████████████████████████████████████████████████████████████████▎            | 47/56 [00:56<00:12,  1.41s/it]Extracting Features (Dev Set):  86%|███████████████████████████████████████████████████████████████████▋           | 48/56 [00:57<00:10,  1.36s/it]Extracting Features (Dev Set):  88%|█████████████████████████████████████████████████████████████████████▏         | 49/56 [00:58<00:09,  1.33s/it]Extracting Features (Dev Set):  89%|██████████████████████████████████████████████████████████████████████▌        | 50/56 [01:00<00:07,  1.32s/it]Extracting Features (Dev Set):  91%|███████████████████████████████████████████████████████████████████████▉       | 51/56 [01:01<00:06,  1.29s/it]Extracting Features (Dev Set):  93%|█████████████████████████████████████████████████████████████████████████▎     | 52/56 [01:02<00:05,  1.26s/it]Extracting Features (Dev Set):  95%|██████████████████████████████████████████████████████████████████████████▊    | 53/56 [01:03<00:03,  1.22s/it]Extracting Features (Dev Set):  96%|████████████████████████████████████████████████████████████████████████████▏  | 54/56 [01:04<00:02,  1.23s/it]Extracting Features (Dev Set):  98%|█████████████████████████████████████████████████████████████████████████████▌ | 55/56 [01:06<00:01,  1.26s/it]Extracting Features (Dev Set): 100%|███████████████████████████████████████████████████████████████████████████████| 56/56 [01:07<00:00,  1.21s/it]Extracting Features (Dev Set): 100%|███████████████████████████████████████████████████████████████████████████████| 56/56 [01:07<00:00,  1.20s/it]

Applying one-hot encoding for 'material' feature.

Development X_dev (shape (56, 7)) and y_dev (shape (56,)) prepared.

--- Running Nested Cross-Validation on Development Set ---
Selected Regressors: ['SVR', 'MLPRegressor', 'XGBRegressor']
    Running Group-Aware Nested CV for SVR: Outer 5-Fold GroupKFold, Inner 3-Fold GroupShuffleSplit
  Aggregated Nested CV Results for SVR:
    Mean R²: 0.3134 +/- 0.2944
    Mean RMSE: 0.3246 +/- 0.1072
    Mean MAE: 0.2369 +/- 0.0659
Saving plot to: output_temp/output-2G-1BC_combined/exp-3/actual_vs_predicted_NESTED_CV_AGG_SVR.png
    Running Group-Aware Nested CV for MLPRegressor: Outer 5-Fold GroupKFold, Inner 3-Fold GroupShuffleSplit
  Aggregated Nested CV Results for MLPRegressor:
    Mean R²: -0.1150 +/- 0.6428
    Mean RMSE: 0.3997 +/- 0.0968
    Mean MAE: 0.3069 +/- 0.0728
Saving plot to: output_temp/output-2G-1BC_combined/exp-3/actual_vs_predicted_NESTED_CV_AGG_MLPRegressor.png
    Running Group-Aware Nested CV for XGBRegressor: Outer 5-Fold GroupKFold, Inner 3-Fold GroupShuffleSplit
  Aggregated Nested CV Results for XGBRegressor:
    Mean R²: 0.3960 +/- 0.1579
    Mean RMSE: 0.3100 +/- 0.0886
    Mean MAE: 0.2349 +/- 0.0563
Saving plot to: output_temp/output-2G-1BC_combined/exp-3/actual_vs_predicted_NESTED_CV_AGG_XGBRegressor.png

--- Best Model Type from Nested CV: XGBRegressor (Mean R²: 0.3960) ---

  Hyperparameter Selection Frequency for XGBRegressor (from 5 outer folds):
    Parameter 'colsample_bytree':
      - 0.7: 3 times
      - 0.9: 1 times
      - 1.0: 1 times
    Parameter 'learning_rate':
      - 0.01: 4 times
      - 0.05: 1 times
    Parameter 'max_depth':
      - 7: 3 times
      - 5: 1 times
      - 3: 1 times
    Parameter 'n_estimators':
      - 100: 3 times
      - 300: 1 times
      - 200: 1 times
    Parameter 'subsample':
      - 0.7: 4 times
      - 1.0: 1 times

--- Final Hyperparameter Tuning for XGBRegressor on Full Development Set ---
  Running final GridSearchCV for XGBRegressor...
Fitting 5 folds for each of 243 candidates, totalling 1215 fits
    Best final score (neg_mean_squared_error): -0.0965
    Best final parameters: {'model__colsample_bytree': 1.0, 'model__learning_rate': 0.01, 'model__max_depth': 7, 'model__n_estimators': 200, 'model__subsample': 0.7}
  Learning curve saved to: output_temp/output-2G-1BC_combined/exp-3/learning_curve_XGBRegressor.png

--- Evaluating Final Model on Hold-Out Set ---
Extracting Features (Hold-Out):   0%|                                                                                       | 0/11 [00:00<?, ?it/s]Extracting Features (Hold-Out):   9%|███████▏                                                                       | 1/11 [00:01<00:13,  1.31s/it]Extracting Features (Hold-Out):  18%|██████████████▎                                                                | 2/11 [00:02<00:10,  1.14s/it]Extracting Features (Hold-Out):  27%|█████████████████████▌                                                         | 3/11 [00:03<00:08,  1.05s/it]Extracting Features (Hold-Out):  36%|████████████████████████████▋                                                  | 4/11 [00:04<00:07,  1.01s/it]Extracting Features (Hold-Out):  45%|███████████████████████████████████▉                                           | 5/11 [00:05<00:06,  1.01s/it]Extracting Features (Hold-Out):  55%|███████████████████████████████████████████                                    | 6/11 [00:06<00:05,  1.07s/it]Extracting Features (Hold-Out):  64%|██████████████████████████████████████████████████▎                            | 7/11 [00:07<00:04,  1.11s/it]Extracting Features (Hold-Out):  73%|█████████████████████████████████████████████████████████▍                     | 8/11 [00:08<00:03,  1.05s/it]Extracting Features (Hold-Out):  82%|████████████████████████████████████████████████████████████████▋              | 9/11 [00:09<00:02,  1.07s/it]Extracting Features (Hold-Out):  91%|██████████████████████████████████████████████████████████████████████▉       | 10/11 [00:10<00:01,  1.06s/it]Extracting Features (Hold-Out): 100%|██████████████████████████████████████████████████████████████████████████████| 11/11 [00:11<00:00,  1.05s/it]Extracting Features (Hold-Out): 100%|██████████████████████████████████████████████████████████████████████████████| 11/11 [00:11<00:00,  1.06s/it]
  Hold-Out Performance (XGBRegressor): R²=-0.2480, RMSE=0.4596
Saving plot to: output_temp/output-2G-1BC_combined/exp-3/actual_vs_predicted_HOLD_OUT_XGBRegressor.png

--- Generating Diagnostic Plots for Best Model ---
  Saved permutation importance plot to: output_temp/output-2G-1BC_combined/exp-3/permutation_importance_XGBRegressor.png
  Saved residuals plot to: output_temp/output-2G-1BC_combined/exp-3/residuals_vs_fitted_XGBRegressor.png

--- Full Evaluation Pipeline Finished ---
