--- Starting Full Evaluation Pipeline for Run: 'combined' | Exp ID: 9 ---

Loading data from dataset: 'gypsum_single_hole' (Material: gypsum)

Loading data from dataset: 'gypsum_single_hole2' (Material: gypsum)

Loading data from dataset: 'brick_cladding_single_hole' (Material: brick_cladding)

Total samples created after loading and splitting: 67
Sample counts per material:
 material
gypsum            47
brick_cladding    20
Name: count, dtype: int64

Creating hold-out set with stratification on airflow rate.
  Created hold-out set (7 samples). Using 60 for development.
Extracting Features (Dev Set):   0%|                                                                                              | 0/60 [00:00<?, ?it/s]Extracting Features (Dev Set):   2%|█▍                                                                                    | 1/60 [00:02<02:28,  2.52s/it]Extracting Features (Dev Set):   3%|██▊                                                                                   | 2/60 [00:04<02:13,  2.31s/it]Extracting Features (Dev Set):   5%|████▎                                                                                 | 3/60 [00:07<02:23,  2.52s/it]Extracting Features (Dev Set):   7%|█████▋                                                                                | 4/60 [00:09<02:14,  2.41s/it]Extracting Features (Dev Set):   8%|███████▏                                                                              | 5/60 [00:11<02:06,  2.30s/it]Extracting Features (Dev Set):  10%|████████▌                                                                             | 6/60 [00:14<02:04,  2.30s/it]Extracting Features (Dev Set):  12%|██████████                                                                            | 7/60 [00:16<02:00,  2.27s/it]Extracting Features (Dev Set):  13%|███████████▍                                                                          | 8/60 [00:18<01:58,  2.29s/it]Extracting Features (Dev Set):  15%|████████████▉                                                                         | 9/60 [00:20<01:55,  2.27s/it]Extracting Features (Dev Set):  17%|██████████████▏                                                                      | 10/60 [00:23<01:51,  2.24s/it]Extracting Features (Dev Set):  18%|███████████████▌                                                                     | 11/60 [00:25<01:59,  2.44s/it]Extracting Features (Dev Set):  20%|█████████████████                                                                    | 12/60 [00:28<01:53,  2.36s/it]Extracting Features (Dev Set):  22%|██████████████████▍                                                                  | 13/60 [00:30<01:51,  2.36s/it]Extracting Features (Dev Set):  23%|███████████████████▊                                                                 | 14/60 [00:32<01:45,  2.30s/it]Extracting Features (Dev Set):  25%|█████████████████████▎                                                               | 15/60 [00:34<01:40,  2.24s/it]Extracting Features (Dev Set):  27%|██████████████████████▋                                                              | 16/60 [00:36<01:35,  2.17s/it]Extracting Features (Dev Set):  28%|████████████████████████                                                             | 17/60 [00:38<01:32,  2.16s/it]Extracting Features (Dev Set):  30%|█████████████████████████▌                                                           | 18/60 [00:41<01:30,  2.16s/it]Extracting Features (Dev Set):  32%|██████████████████████████▉                                                          | 19/60 [00:43<01:27,  2.15s/it]Extracting Features (Dev Set):  33%|████████████████████████████▎                                                        | 20/60 [00:45<01:25,  2.13s/it]Extracting Features (Dev Set):  35%|█████████████████████████████▋                                                       | 21/60 [00:47<01:22,  2.12s/it]Extracting Features (Dev Set):  37%|███████████████████████████████▏                                                     | 22/60 [00:49<01:20,  2.11s/it]Extracting Features (Dev Set):  38%|████████████████████████████████▌                                                    | 23/60 [00:51<01:20,  2.18s/it]Extracting Features (Dev Set):  40%|██████████████████████████████████                                                   | 24/60 [00:54<01:19,  2.22s/it]Extracting Features (Dev Set):  42%|███████████████████████████████████▍                                                 | 25/60 [00:56<01:16,  2.19s/it]Extracting Features (Dev Set):  43%|████████████████████████████████████▊                                                | 26/60 [00:58<01:14,  2.20s/it]Extracting Features (Dev Set):  45%|██████████████████████████████████████▎                                              | 27/60 [01:00<01:13,  2.24s/it]Extracting Features (Dev Set):  47%|███████████████████████████████████████▋                                             | 28/60 [01:02<01:11,  2.23s/it]Extracting Features (Dev Set):  48%|█████████████████████████████████████████                                            | 29/60 [01:05<01:08,  2.21s/it]Extracting Features (Dev Set):  50%|██████████████████████████████████████████▌                                          | 30/60 [01:07<01:07,  2.24s/it]Extracting Features (Dev Set):  52%|███████████████████████████████████████████▉                                         | 31/60 [01:09<01:04,  2.23s/it]Extracting Features (Dev Set):  53%|█████████████████████████████████████████████▎                                       | 32/60 [01:11<01:03,  2.26s/it]Extracting Features (Dev Set):  55%|██████████████████████████████████████████████▊                                      | 33/60 [01:14<01:01,  2.27s/it]Extracting Features (Dev Set):  57%|████████████████████████████████████████████████▏                                    | 34/60 [01:16<00:57,  2.22s/it]Extracting Features (Dev Set):  58%|█████████████████████████████████████████████████▌                                   | 35/60 [01:18<00:54,  2.16s/it]Extracting Features (Dev Set):  60%|███████████████████████████████████████████████████                                  | 36/60 [01:20<00:52,  2.17s/it]Extracting Features (Dev Set):  62%|████████████████████████████████████████████████████▍                                | 37/60 [01:22<00:49,  2.15s/it]Extracting Features (Dev Set):  63%|█████████████████████████████████████████████████████▊                               | 38/60 [01:24<00:47,  2.15s/it]Extracting Features (Dev Set):  65%|███████████████████████████████████████████████████████▎                             | 39/60 [01:27<00:46,  2.21s/it]Extracting Features (Dev Set):  67%|████████████████████████████████████████████████████████▋                            | 40/60 [01:29<00:45,  2.27s/it]Extracting Features (Dev Set):  68%|██████████████████████████████████████████████████████████                           | 41/60 [01:31<00:42,  2.21s/it]Extracting Features (Dev Set):  70%|███████████████████████████████████████████████████████████▍                         | 42/60 [01:33<00:39,  2.17s/it]Extracting Features (Dev Set):  72%|████████████████████████████████████████████████████████████▉                        | 43/60 [01:35<00:35,  2.11s/it]Extracting Features (Dev Set):  73%|██████████████████████████████████████████████████████████████▎                      | 44/60 [01:37<00:33,  2.07s/it]Extracting Features (Dev Set):  75%|███████████████████████████████████████████████████████████████▊                     | 45/60 [01:39<00:31,  2.08s/it]Extracting Features (Dev Set):  77%|█████████████████████████████████████████████████████████████████▏                   | 46/60 [01:42<00:29,  2.12s/it]Extracting Features (Dev Set):  78%|██████████████████████████████████████████████████████████████████▌                  | 47/60 [01:43<00:26,  2.08s/it]Extracting Features (Dev Set):  80%|████████████████████████████████████████████████████████████████████                 | 48/60 [01:46<00:25,  2.09s/it]Extracting Features (Dev Set):  82%|█████████████████████████████████████████████████████████████████████▍               | 49/60 [01:48<00:22,  2.08s/it]Extracting Features (Dev Set):  83%|██████████████████████████████████████████████████████████████████████▊              | 50/60 [01:50<00:21,  2.17s/it]Extracting Features (Dev Set):  85%|████████████████████████████████████████████████████████████████████████▎            | 51/60 [01:52<00:19,  2.19s/it]Extracting Features (Dev Set):  87%|█████████████████████████████████████████████████████████████████████████▋           | 52/60 [01:54<00:17,  2.18s/it]Extracting Features (Dev Set):  88%|███████████████████████████████████████████████████████████████████████████          | 53/60 [01:56<00:14,  2.13s/it]Extracting Features (Dev Set):  90%|████████████████████████████████████████████████████████████████████████████▌        | 54/60 [01:59<00:13,  2.18s/it]Extracting Features (Dev Set):  92%|█████████████████████████████████████████████████████████████████████████████▉       | 55/60 [02:01<00:10,  2.15s/it]Extracting Features (Dev Set):  93%|███████████████████████████████████████████████████████████████████████████████▎     | 56/60 [02:03<00:08,  2.22s/it]Extracting Features (Dev Set):  95%|████████████████████████████████████████████████████████████████████████████████▊    | 57/60 [02:05<00:06,  2.16s/it]Extracting Features (Dev Set):  97%|██████████████████████████████████████████████████████████████████████████████████▏  | 58/60 [02:08<00:04,  2.21s/it]Extracting Features (Dev Set):  98%|███████████████████████████████████████████████████████████████████████████████████▌ | 59/60 [02:10<00:02,  2.18s/it]Extracting Features (Dev Set): 100%|█████████████████████████████████████████████████████████████████████████████████████| 60/60 [02:12<00:00,  2.20s/it]Extracting Features (Dev Set): 100%|█████████████████████████████████████████████████████████████████████████████████████| 60/60 [02:12<00:00,  2.21s/it]

Applying one-hot encoding for 'material' feature.

Development X_dev (shape (60, 12)) and y_dev (shape (60,)) prepared.
Feature set: ['delta_T_log', 'hotspot_area_log', 'hotspot_avg_temp_change_rate_initial_norm', 'hotspot_solidity', 'material_brick_cladding', 'material_gypsum', 'radial_profile_0', 'radial_profile_1', 'radial_profile_2', 'radial_profile_3', 'radial_profile_4', 'temp_std_avg_initial']

--- Running Nested Cross-Validation on Development Set ---
Selected Regressors: ['SVR', 'MLPRegressor', 'XGBRegressor']
    Running Group-Aware Nested CV for SVR: Outer 5-Fold GroupKFold, Inner 3-Fold GroupShuffleSplit
  Aggregated Nested CV Results for SVR:
    Mean R²: 0.3265 +/- 0.2686
    Mean RMSE: 0.3318 +/- 0.0834
    Mean MAE: 0.2414 +/- 0.0564
Saving plot to: output_temp/output-2G-1BC_combined/exp-9/actual_vs_predicted_NESTED_CV_AGG_SVR.png
    Running Group-Aware Nested CV for MLPRegressor: Outer 5-Fold GroupKFold, Inner 3-Fold GroupShuffleSplit
  Aggregated Nested CV Results for MLPRegressor:
    Mean R²: -0.0157 +/- 0.2600
    Mean RMSE: 0.4117 +/- 0.0664
    Mean MAE: 0.3188 +/- 0.0579
Saving plot to: output_temp/output-2G-1BC_combined/exp-9/actual_vs_predicted_NESTED_CV_AGG_MLPRegressor.png
    Running Group-Aware Nested CV for XGBRegressor: Outer 5-Fold GroupKFold, Inner 3-Fold GroupShuffleSplit
  Aggregated Nested CV Results for XGBRegressor:
    Mean R²: 0.3621 +/- 0.2127
    Mean RMSE: 0.3248 +/- 0.0683
    Mean MAE: 0.2286 +/- 0.0291
Saving plot to: output_temp/output-2G-1BC_combined/exp-9/actual_vs_predicted_NESTED_CV_AGG_XGBRegressor.png

--- Best Model Type from Nested CV: XGBRegressor (Mean R²: 0.3621) ---

  Hyperparameter Selection Frequency for XGBRegressor (from 5 outer folds):
    Parameter 'colsample_bytree':
      - 0.7: 3 times
      - 0.8: 2 times
    Parameter 'gamma':
      - 0.5: 5 times
    Parameter 'learning_rate':
      - 0.2: 4 times
      - 0.1: 1 times
    Parameter 'max_depth':
      - 3: 3 times
      - 2: 2 times
    Parameter 'n_estimators':
      - 150: 3 times
      - 100: 1 times
      - 50: 1 times
    Parameter 'reg_alpha':
      - 0.1: 3 times
      - 0: 2 times
    Parameter 'reg_lambda':
      - 1: 2 times
      - 2: 2 times
      - 1.5: 1 times
    Parameter 'subsample':
      - 0.7: 3 times
      - 0.8: 2 times

--- Final Hyperparameter Tuning for XGBRegressor on Full Development Set ---
  Running final GridSearchCV for XGBRegressor...
Fitting 5 folds for each of 2916 candidates, totalling 14580 fits
    Best final score (neg_mean_squared_error): -0.1144
    Best final parameters: {'model__colsample_bytree': 0.7, 'model__gamma': 0.1, 'model__learning_rate': 0.1, 'model__max_depth': 2, 'model__n_estimators': 100, 'model__reg_alpha': 0.5, 'model__reg_lambda': 1.5, 'model__subsample': 0.8}
  Learning curve saved to: output_temp/output-2G-1BC_combined/exp-9/learning_curve_XGBRegressor.png

--- Evaluating Final Model on Hold-Out Set ---
Extracting Features (Hold-Out):   0%|                                                                                              | 0/7 [00:00<?, ?it/s]Extracting Features (Hold-Out):  14%|████████████▎                                                                         | 1/7 [00:02<00:17,  2.93s/it]Extracting Features (Hold-Out):  29%|████████████████████████▌                                                             | 2/7 [00:05<00:13,  2.62s/it]Extracting Features (Hold-Out):  43%|████████████████████████████████████▊                                                 | 3/7 [00:07<00:10,  2.59s/it]Extracting Features (Hold-Out):  57%|█████████████████████████████████████████████████▏                                    | 4/7 [00:10<00:07,  2.66s/it]Extracting Features (Hold-Out):  71%|█████████████████████████████████████████████████████████████▍                        | 5/7 [00:13<00:05,  2.73s/it]Extracting Features (Hold-Out):  86%|█████████████████████████████████████████████████████████████████████████▋            | 6/7 [00:15<00:02,  2.58s/it]Extracting Features (Hold-Out): 100%|██████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:18<00:00,  2.50s/it]Extracting Features (Hold-Out): 100%|██████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:18<00:00,  2.59s/it]
  Hold-Out Performance (XGBRegressor): R²=0.4055, RMSE=0.3366
Saving plot to: output_temp/output-2G-1BC_combined/exp-9/actual_vs_predicted_HOLD_OUT_XGBRegressor.png

--- Generating Diagnostic Plots for Best Model ---
  Saved permutation importance plot to: output_temp/output-2G-1BC_combined/exp-9/permutation_importance_XGBRegressor.png
  Saved residuals plot to: output_temp/output-2G-1BC_combined/exp-9/residuals_vs_fitted_XGBRegressor.png

--- Full Evaluation Pipeline Finished ---
