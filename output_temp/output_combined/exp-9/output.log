--- Starting Full Evaluation Pipeline for Run: 'combined' | Exp ID: 9 ---

Loading data from dataset: 'gypsum_single_hole' (Material: gypsum)

Loading data from dataset: 'brick_cladding_single_hole' (Material: brick_cladding)

Loading data from dataset: 'brick_cladding_two_holes' (Material: brick_cladding)

Total samples created after loading and splitting: 48
Sample counts per material:
 material
brick_cladding    30
gypsum            18
Name: count, dtype: int64

Creating hold-out set.
  Created hold-out set (8 samples). Using 40 for development.
Extracting Features (Dev Set):   0%|                                                                       | 0/40 [00:00<?, ?it/s]Extracting Features (Dev Set):   2%|█▌                                                             | 1/40 [00:01<01:06,  1.70s/it]Extracting Features (Dev Set):   5%|███▏                                                           | 2/40 [00:02<00:53,  1.41s/it]Extracting Features (Dev Set):   8%|████▋                                                          | 3/40 [00:04<00:55,  1.51s/it]Extracting Features (Dev Set):  10%|██████▎                                                        | 4/40 [00:06<01:00,  1.68s/it]Extracting Features (Dev Set):  12%|███████▉                                                       | 5/40 [00:07<00:55,  1.57s/it]Extracting Features (Dev Set):  15%|█████████▍                                                     | 6/40 [00:09<00:52,  1.53s/it]Extracting Features (Dev Set):  18%|███████████                                                    | 7/40 [00:10<00:49,  1.49s/it]Extracting Features (Dev Set):  20%|████████████▌                                                  | 8/40 [00:11<00:44,  1.39s/it]Extracting Features (Dev Set):  22%|██████████████▏                                                | 9/40 [00:13<00:41,  1.35s/it]Extracting Features (Dev Set):  25%|███████████████▌                                              | 10/40 [00:14<00:38,  1.29s/it]Extracting Features (Dev Set):  28%|█████████████████                                             | 11/40 [00:15<00:36,  1.26s/it]Extracting Features (Dev Set):  30%|██████████████████▌                                           | 12/40 [00:16<00:35,  1.27s/it]Extracting Features (Dev Set):  32%|████████████████████▏                                         | 13/40 [00:17<00:33,  1.22s/it]Extracting Features (Dev Set):  35%|█████████████████████▋                                        | 14/40 [00:18<00:30,  1.17s/it]Extracting Features (Dev Set):  38%|███████████████████████▎                                      | 15/40 [00:20<00:29,  1.18s/it]Extracting Features (Dev Set):  40%|████████████████████████▊                                     | 16/40 [00:21<00:28,  1.17s/it]Extracting Features (Dev Set):  42%|██████████████████████████▎                                   | 17/40 [00:22<00:26,  1.16s/it]Extracting Features (Dev Set):  45%|███████████████████████████▉                                  | 18/40 [00:23<00:25,  1.18s/it]Extracting Features (Dev Set):  48%|█████████████████████████████▍                                | 19/40 [00:24<00:24,  1.17s/it]Extracting Features (Dev Set):  50%|███████████████████████████████                               | 20/40 [00:26<00:23,  1.18s/it]Extracting Features (Dev Set):  52%|████████████████████████████████▌                             | 21/40 [00:27<00:21,  1.15s/it]Extracting Features (Dev Set):  55%|██████████████████████████████████                            | 22/40 [00:28<00:20,  1.15s/it]Extracting Features (Dev Set):  57%|███████████████████████████████████▋                          | 23/40 [00:29<00:20,  1.18s/it]Extracting Features (Dev Set):  60%|█████████████████████████████████████▏                        | 24/40 [00:30<00:18,  1.17s/it]Extracting Features (Dev Set):  62%|██████████████████████████████████████▊                       | 25/40 [00:31<00:17,  1.14s/it]Extracting Features (Dev Set):  65%|████████████████████████████████████████▎                     | 26/40 [00:33<00:17,  1.22s/it]Extracting Features (Dev Set):  68%|█████████████████████████████████████████▊                    | 27/40 [00:34<00:16,  1.28s/it]Extracting Features (Dev Set):  70%|███████████████████████████████████████████▍                  | 28/40 [00:35<00:14,  1.24s/it]Extracting Features (Dev Set):  72%|████████████████████████████████████████████▉                 | 29/40 [00:37<00:13,  1.26s/it]Extracting Features (Dev Set):  75%|██████████████████████████████████████████████▌               | 30/40 [00:38<00:12,  1.24s/it]Extracting Features (Dev Set):  78%|████████████████████████████████████████████████              | 31/40 [00:39<00:10,  1.20s/it]Extracting Features (Dev Set):  80%|█████████████████████████████████████████████████▌            | 32/40 [00:40<00:09,  1.21s/it]Extracting Features (Dev Set):  82%|███████████████████████████████████████████████████▏          | 33/40 [00:41<00:08,  1.18s/it]Extracting Features (Dev Set):  85%|████████████████████████████████████████████████████▋         | 34/40 [00:42<00:06,  1.16s/it]Extracting Features (Dev Set):  88%|██████████████████████████████████████████████████████▎       | 35/40 [00:43<00:05,  1.17s/it]Extracting Features (Dev Set):  90%|███████████████████████████████████████████████████████▊      | 36/40 [00:45<00:04,  1.18s/it]Extracting Features (Dev Set):  92%|█████████████████████████████████████████████████████████▎    | 37/40 [00:46<00:03,  1.17s/it]Extracting Features (Dev Set):  95%|██████████████████████████████████████████████████████████▉   | 38/40 [00:47<00:02,  1.17s/it]Extracting Features (Dev Set):  98%|████████████████████████████████████████████████████████████▍ | 39/40 [00:48<00:01,  1.16s/it]Extracting Features (Dev Set): 100%|██████████████████████████████████████████████████████████████| 40/40 [00:49<00:00,  1.17s/it]Extracting Features (Dev Set): 100%|██████████████████████████████████████████████████████████████| 40/40 [00:49<00:00,  1.25s/it]

Applying one-hot encoding for 'material' feature.

Development X_dev (shape (40, 8)) and y_dev (shape (40,)) prepared.

--- Running Nested Cross-Validation on Development Set ---
Selected Regressors: ['SVR', 'MLPRegressor', 'XGBRegressor']
    Running Group-Aware Nested CV for SVR: Outer 5-Fold GroupKFold, Inner 3-Fold GroupShuffleSplit
  Aggregated Nested CV Results for SVR:
    Mean R²: 0.3061 +/- 0.1858
    Mean RMSE: 0.2492 +/- 0.0440
    Mean MAE: 0.2112 +/- 0.0415
Saving plot to: output_temp/output_combined/exp-9/actual_vs_predicted_NESTED_CV_AGG_SVR.png
    Running Group-Aware Nested CV for MLPRegressor: Outer 5-Fold GroupKFold, Inner 3-Fold GroupShuffleSplit
  Aggregated Nested CV Results for MLPRegressor:
    Mean R²: 0.1984 +/- 0.7657
    Mean RMSE: 0.2400 +/- 0.0585
    Mean MAE: 0.2139 +/- 0.0638
Saving plot to: output_temp/output_combined/exp-9/actual_vs_predicted_NESTED_CV_AGG_MLPRegressor.png
    Running Group-Aware Nested CV for XGBRegressor: Outer 5-Fold GroupKFold, Inner 3-Fold GroupShuffleSplit
  Aggregated Nested CV Results for XGBRegressor:
    Mean R²: 0.4793 +/- 0.2486
    Mean RMSE: 0.2136 +/- 0.0716
    Mean MAE: 0.1687 +/- 0.0601
Saving plot to: output_temp/output_combined/exp-9/actual_vs_predicted_NESTED_CV_AGG_XGBRegressor.png

--- Best Model Type from Nested CV: XGBRegressor (Mean R²: 0.4793) ---

  Hyperparameter Selection Frequency for XGBRegressor (from 5 outer folds):
    Parameter 'colsample_bytree':
      - 0.8: 3 times
      - 1.0: 2 times
    Parameter 'learning_rate':
      - 0.05: 3 times
      - 0.1: 2 times
    Parameter 'max_depth':
      - 7: 2 times
      - 3: 2 times
      - 5: 1 times
    Parameter 'n_estimators':
      - 100: 3 times
      - 200: 2 times
    Parameter 'subsample':
      - 1.0: 3 times
      - 0.8: 2 times

--- Final Hyperparameter Tuning for XGBRegressor on Full Development Set ---
  Running final GridSearchCV for XGBRegressor...
Fitting 5 folds for each of 48 candidates, totalling 240 fits
    Best final score (neg_mean_squared_error): -0.0569
    Best final parameters: {'model__colsample_bytree': 1.0, 'model__learning_rate': 0.05, 'model__max_depth': 3, 'model__n_estimators': 100, 'model__subsample': 0.8}
  Learning curve saved to: output_temp/output_combined/exp-9/learning_curve_XGBRegressor.png

--- Evaluating Final Model on Hold-Out Set ---
Extracting Features (Hold-Out):   0%|                                                                       | 0/8 [00:00<?, ?it/s]Extracting Features (Hold-Out):  12%|███████▉                                                       | 1/8 [00:01<00:09,  1.37s/it]Extracting Features (Hold-Out):  25%|███████████████▊                                               | 2/8 [00:02<00:07,  1.30s/it]Extracting Features (Hold-Out):  38%|███████████████████████▋                                       | 3/8 [00:04<00:06,  1.35s/it]Extracting Features (Hold-Out):  50%|███████████████████████████████▌                               | 4/8 [00:05<00:05,  1.28s/it]Extracting Features (Hold-Out):  62%|███████████████████████████████████████▍                       | 5/8 [00:06<00:03,  1.23s/it]Extracting Features (Hold-Out):  75%|███████████████████████████████████████████████▎               | 6/8 [00:07<00:02,  1.21s/it]Extracting Features (Hold-Out):  88%|███████████████████████████████████████████████████████▏       | 7/8 [00:08<00:01,  1.19s/it]Extracting Features (Hold-Out): 100%|███████████████████████████████████████████████████████████████| 8/8 [00:09<00:00,  1.17s/it]Extracting Features (Hold-Out): 100%|███████████████████████████████████████████████████████████████| 8/8 [00:09<00:00,  1.23s/it]
  Hold-Out Performance (XGBRegressor): R²=0.6187, RMSE=0.1987
Saving plot to: output_temp/output_combined/exp-9/actual_vs_predicted_HOLD_OUT_XGBRegressor.png

--- Generating Diagnostic Plots for Best Model ---
  Saved permutation importance plot to: output_temp/output_combined/exp-9/permutation_importance_XGBRegressor.png
  Saved residuals plot to: output_temp/output_combined/exp-9/residuals_vs_fitted_XGBRegressor.png

--- Full Evaluation Pipeline Finished ---
